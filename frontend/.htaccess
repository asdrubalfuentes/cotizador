# SPA fallback + security headers para React/Vite en cPanel (Apache)
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.html [L]
</IfModule>

# Seguridad: fuerza HTTPS (si tienes cert y quieres redirigir todo a https)
<IfModule mod_rewrite.c>
  RewriteCond %{HTTPS} !=on
  RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>

<IfModule mod_headers.c>
  # Política de seguridad de contenido (ajusta dominios según tus URLs)
  Header always set Content-Security-Policy "default-src 'self'; \
    script-src 'self' https://cdn.jsdelivr.net; \
    style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; \
    img-src 'self' data: https://emqx.aysafi.com https://emqx.aysafi.com:8443; \
    connect-src 'self' https://emqx.aysafi.com https://emqx.aysafi.com:8443 https://cdn.jsdelivr.net https://mindicador.cl; \
    font-src 'self' https://cdn.jsdelivr.net; \
    frame-ancestors 'none'; base-uri 'self'; upgrade-insecure-requests; block-all-mixed-content"

  # Cabeceras adicionales recomendadas
  Header always set X-Content-Type-Options "nosniff"
  Header always set X-Frame-Options "DENY"
  Header always set Referrer-Policy "no-referrer"
  Header always set Permissions-Policy "geolocation=(), camera=(), microphone=()"
</IfModule>

# HSTS (activa solo cuando ya sirves HTTPS correctamente)
# <IfModule mod_headers.c>
#   Header always set Strict-Transport-Security "max-age=15552000; includeSubDomains; preload"
# </IfModule>
